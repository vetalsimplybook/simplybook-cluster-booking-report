<!DOCTYPE html>
<html lang="">
<head>
    <meta charset="utf-8">
    <title>Cluster common booking report</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
            integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
            crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="js/script.js"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
<div class="container">
    <header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom">
        <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">
            <svg class="bi me-2" width="40" height="32">
                <use xlink:href="#bootstrap"></use>
            </svg>
            <span class="fs-4">Cluster booking report</span>
        </a>

        <ul class="nav nav-pills">
            <!--<li class="nav-item"><a href="#" class="nav-link active" aria-current="page">Import</a></li>-->
        </ul>
    </header>


    <main>

        <div class="step step-1">

            <div class="form-signin w-100 m-auto">
                <form id="form-signin" action="#" method="post">
                    <svg class="header--logo-image mb-4" xmlns="http://www.w3.org/2000/svg"  height="40" viewBox="0 0 122.55 18.92"> <defs> <style>.cls-1l, .cls-2l { fill: #2eabe2; } .cls-1l, .cls-3l { fill-rule: evenodd; } .cls-3l { fill: #26334b; }</style> </defs> <title>SimplyBook.me</title> <g id="Layer_2" data-name="Layer 2"> <g id="Layer_1-2" data-name="Layer 1"> <path class="cls-1l" d="M4.61,5.9A9.29,9.29,0,0,0,7,6.91l1.1.37a8.8,8.8,0,0,1,1,.39l.35.14,3.15-3h.22L4.19,17.05,0,13.27l2.16-2.18,2,1.83,3-2.89c-.43-.16-.93-.32-1.53-.49A10.12,10.12,0,0,1,2.35,8.06,3.89,3.89,0,0,1,.84,4.76,4.26,4.26,0,0,1,2.37,1.3,5.62,5.62,0,0,1,6.1,0a6,6,0,0,1,5.28,2.84L9.15,5.11a3.2,3.2,0,0,0-3.05-2C4.79,3.07,4,3.73,4,4.67A1.5,1.5,0,0,0,4.61,5.9Zm7.65,5.93a4.31,4.31,0,0,1-1.62,3.53,6.35,6.35,0,0,1-4,1.3l5-7A4.3,4.3,0,0,1,12.26,11.83Z"></path> <path class="cls-2l" d="M14.92,3.13A1.4,1.4,0,0,0,13.53,4.5a1.4,1.4,0,0,0,2.79,0A1.4,1.4,0,0,0,14.92,3.13ZM13.79,15.48h2.27V6.89H13.79ZM27.43,6.65a3,3,0,0,0-2.62,1.24,2.61,2.61,0,0,0-2.39-1.24A2.76,2.76,0,0,0,20,7.8V6.89H17.71v8.59H20V10.65c0-1.25.65-1.94,1.66-1.94s1.47.6,1.47,1.63v5.14h2.27V10.65c0-1.25.6-1.94,1.64-1.94s1.47.6,1.47,1.63v5.14h2.27V10.19A3.22,3.22,0,0,0,27.43,6.65Zm10,0A3.43,3.43,0,0,0,34.61,7.9v-1H32.35v12h2.26V14.46a3.44,3.44,0,0,0,2.85,1.26,4,4,0,0,0,3-1.31,4.49,4.49,0,0,0,1.26-3.23A4.46,4.46,0,0,0,40.49,8,4.06,4.06,0,0,0,37.46,6.65Zm1.32,6.28a2.43,2.43,0,0,1-4.17-1.75,2.32,2.32,0,0,1,.69-1.73,2.54,2.54,0,0,1,3.48,0,2.26,2.26,0,0,1,.7,1.73A2.3,2.3,0,0,1,38.78,12.93ZM43,15.48h2.27V2.94H43Zm7.67-2.82L48.34,6.89H45.86l3.6,8.31a2.14,2.14,0,0,1-2.3,1.65v2.06c2.25.12,3.73-1,4.64-3.43L55,6.89H52.57Zm12.5-3.42a2.88,2.88,0,0,0,1.16-2.4,3.05,3.05,0,0,0-1.09-2.42,3.84,3.84,0,0,0-2.65-1H55.69v12h5.22a4,4,0,0,0,2.72-1A3.22,3.22,0,0,0,64.74,12,3,3,0,0,0,63.12,9.24Zm-5-3.57h2.43A1.28,1.28,0,0,1,61.86,7a1.29,1.29,0,0,1-1.32,1.33H58.11Zm2.8,7.59h-2.8V10.43h2.8a1.42,1.42,0,1,1,0,2.83Zm9.23-6.61A4.61,4.61,0,0,0,66.83,8a4.32,4.32,0,0,0-1.33,3.21,4.35,4.35,0,0,0,1.33,3.23a4.82,4.82,0,0,0,6.61,0,4.34,4.34,0,0,0,1.36-3.23A4.31,4.31,0,0,0,73.44,8A4.57,4.57,0,0,0,70.14,6.65Zm1.7,6.23a2.38,2.38,0,0,1-4.08-1.7,2.41,2.41,0,0,1,4.08-1.7,2.28,2.28,0,0,1,.69,1.7A2.25,2.25,0,0,1,71.84,12.88ZM80.1,6.65A4.57,4.57,0,0,0,76.8,8a4.3,4.3,0,0,0-1.34,3.21,4.32,4.32,0,0,0,1.34,3.23a4.82,4.82,0,0,0,6.61,0,4.37,4.37,0,0,0,1.35-3.23A4.34,4.34,0,0,0,83.41,8A4.61,4.61,0,0,0,80.1,6.65Zm1.71,6.23A2.41,2.41,0,1,1,80.1,8.81a2.37,2.37,0,0,1,1.71.67,2.28,2.28,0,0,1,.68,1.7A2.25,2.25,0,0,1,81.81,12.88Zm8.57-1.75,3.53-4.24H91.2l-3,3.78V3.46H85.91v12h2.27v-3.9l3.2,3.9H94Z"></path> <path class="cls-3l" d="M122.46,12.09h-6.62a2.22,2.22,0,0,0,2.47,1.62,2.34,2.34,0,0,0,2-.86l1.83,1a4.39,4.39,0,0,1-3.83,1.84a4.78,4.78,0,0,1-3.5-1.29,4.35,4.35,0,0,1-1.32-3.25A4.37,4.37,0,0,1,114.76,8a4.48,4.48,0,0,1,3.34-1.31A4.19,4.19,0,0,1,121.29,8a4.45,4.45,0,0,1,1.26,3.22A4.84,4.84,0,0,1,122.46,12.09ZM118.1,8.64a2.18,2.18,0,0,0-2.3,1.74h4.48A2.11,2.11,0,0,0,118.1,8.64Zm-8,1.7c0-1-.54-1.63-1.48-1.63S107,9.4,107,10.65v4.83h-2.27V10.34c0-1-.54-1.63-1.47-1.63s-1.66.69-1.66,1.94v4.83H99.32V6.89h2.27V7.8A2.76,2.76,0,0,1,104,6.65a2.61,2.61,0,0,1,2.39,1.24,3,3,0,0,1,2.62-1.24,3.22,3.22,0,0,1,3.32,3.54v5.29H110.1ZM95.36,15.27a1.44,1.44,0,0,1,0-2.06,1.52,1.52,0,0,1,2.11,0,1.44,1.44,0,0,1,0,2.06A1.52,1.52,0,0,1,95.36,15.27Z"></path> </g> </g> </svg>
                    <h1 class="h3 mb-3 fw-normal">Cluster API Authentication</h1>

                    <div class="form-floating mb-3">
                        <input type="text" class="form-control" id="api_key" name="api_key" placeholder="Enter API Key" required>
                        <label for="api_key">API Key</label>
                    </div>

                    <div class="form-floating mb-3">
                        <input type="text" class="form-control" id="cluster" name="cluster" placeholder="Enter cluster name" required>
                        <label for="cluster">Cluster</label>
                    </div>

                    <div class="form-floating mb-3">
                        <select class="form-select" id="domain_select" name="domain_select">
                            <option value="">Select domain...</option>
                            <option value="simplybook.vip">simplybook.vip</option>
                            <option value="simplybook.pro">simplybook.pro</option>
                            <option value="simplybook.plus">simplybook.plus</option>
                            <option value="simplybook.us">simplybook.us</option>
                            <option value="simplybook.cc">simplybook.cc</option>
                            <option value="enterpriseappointments.com">enterpriseappointments.com</option>
                            <option value="custom">Custom domain...</option>
                        </select>
                        <label for="domain_select">Domain</label>
                    </div>

                    <div class="form-floating mb-3" style="display:none;" id="domain_custom_container">
                        <input type="text" class="form-control" id="domain_custom" name="domain_custom" placeholder="example.simplybook.me">
                        <label for="domain_custom">Custom domain</label>
                    </div>

                    <input type="hidden" id="domain_final" name="domain_final" value="">

                    <button class="btn btn-primary w-100 py-3 mb-3" id="authenticate-btn" type="submit">
                        <i class="fas fa-key me-2"></i>Authenticate & Connect
                    </button>

                    <div class="text-center">
                        <button class="btn btn-demo" id="demo-login" type="button">
                            <i class="fas fa-magic me-1"></i>Fill demo credentials
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div class="step step-2 hidden">
            <div class="form-companies w-100 m-auto">
                <svg class="header--logo-image mb-4" xmlns="http://www.w3.org/2000/svg" height="40" viewBox="0 0 122.55 18.92">
                    <defs> <style>.cls-1l, .cls-2l { fill: #2eabe2; } .cls-1l, .cls-3l { fill-rule: evenodd; } .cls-3l { fill: #26334b; }</style> </defs>
                    <title>SimplyBook.me</title>
                    <g id="Layer_2" data-name="Layer 2"> <g id="Layer_1-2" data-name="Layer 1">
                        <path class="cls-1l" d="M4.61,5.9A9.29,9.29,0,0,0,7,6.91l1.1.37a8.8,8.8,0,0,1,1,.39l.35.14,3.15-3h.22L4.19,17.05,0,13.27l2.16-2.18,2,1.83,3-2.89c-.43-.16-.93-.32-1.53-.49A10.12,10.12,0,0,1,2.35,8.06,3.89,3.89,0,0,1,.84,4.76,4.26,4.26,0,0,1,2.37,1.3,5.62,5.62,0,0,1,6.1,0a6,6,0,0,1,5.28,2.84L9.15,5.11a3.2,3.2,0,0,0-3.05-2C4.79,3.07,4,3.73,4,4.67A1.5,1.5,0,0,0,4.61,5.9Zm7.65,5.93a4.31,4.31,0,0,1-1.62,3.53,6.35,6.35,0,0,1-4,1.3l5-7A4.3,4.3,0,0,1,12.26,11.83Z"></path>
                        <path class="cls-2l" d="M14.92,3.13A1.4,1.4,0,0,0,13.53,4.5a1.4,1.4,0,0,0,2.79,0A1.4,1.4,0,0,0,14.92,3.13ZM13.79,15.48h2.27V6.89H13.79ZM27.43,6.65a3,3,0,0,0-2.62,1.24,2.61,2.61,0,0,0-2.39-1.24A2.76,2.76,0,0,0,20,7.8V6.89H17.71v8.59H20V10.65c0-1.25.65-1.94,1.66-1.94s1.47.6,1.47,1.63v5.14h2.27V10.65c0-1.25.6-1.94,1.64-1.94s1.47.6,1.47,1.63v5.14h2.27V10.19A3.22,3.22,0,0,0,27.43,6.65Zm10,0A3.43,3.43,0,0,0,34.61,7.9v-1H32.35v12h2.26V14.46a3.44,3.44,0,0,0,2.85,1.26,4,4,0,0,0,3-1.31,4.49,4.49,0,0,0,1.26-3.23A4.46,4.46,0,0,0,40.49,8,4.06,4.06,0,0,0,37.46,6.65Zm1.32,6.28a2.43,2.43,0,0,1-4.17-1.75,2.32,2.32,0,0,1,.69-1.73,2.54,2.54,0,0,1,3.48,0,2.26,2.26,0,0,1,.7,1.73A2.3,2.3,0,0,1,38.78,12.93ZM43,15.48h2.27V2.94H43Zm7.67-2.82L48.34,6.89H45.86l3.6,8.31a2.14,2.14,0,0,1-2.3,1.65v2.06c2.25.12,3.73-1,4.64-3.43L55,6.89H52.57Zm12.5-3.42a2.88,2.88,0,0,0,1.16-2.4,3.05,3.05,0,0,0-1.09-2.42,3.84,3.84,0,0,0-2.65-1H55.69v12h5.22a4,4,0,0,0,2.72-1A3.22,3.22,0,0,0,64.74,12,3,3,0,0,0,63.12,9.24Zm-5-3.57h2.43A1.28,1.28,0,0,1,61.86,7a1.29,1.29,0,0,1-1.32,1.33H58.11Zm2.8,7.59h-2.8V10.43h2.8a1.42,1.42,0,1,1,0,2.83Zm9.23-6.61A4.61,4.61,0,0,0,66.83,8a4.32,4.32,0,0,0-1.33,3.21,4.35,4.35,0,0,0,1.33,3.23a4.82,4.82,0,0,0,6.61,0,4.34,4.34,0,0,0,1.36-3.23A4.31,4.31,0,0,0,73.44,8A4.57,4.57,0,0,0,70.14,6.65Zm1.7,6.23a2.38,2.38,0,0,1-4.08-1.7,2.41,2.41,0,0,1,4.08-1.7,2.28,2.28,0,0,1,.69,1.7A2.25,2.25,0,0,1,71.84,12.88ZM80.1,6.65A4.57,4.57,0,0,0,76.8,8a4.3,4.3,0,0,0-1.34,3.21,4.32,4.32,0,0,0,1.34,3.23a4.82,4.82,0,0,0,6.61,0,4.37,4.37,0,0,0,1.35-3.23A4.34,4.34,0,0,0,83.41,8A4.61,4.61,0,0,0,80.1,6.65Zm1.71,6.23A2.41,2.41,0,1,1,80.1,8.81a2.37,2.37,0,0,1,1.71.67,2.28,2.28,0,0,1,.68,1.7A2.25,2.25,0,0,1,81.81,12.88Zm8.57-1.75,3.53-4.24H91.2l-3,3.78V3.46H85.91v12h2.27v-3.9l3.2,3.9H94Z"></path> <path class="cls-3l" d="M122.46,12.09h-6.62a2.22,2.22,0,0,0,2.47,1.62,2.34,2.34,0,0,0,2-.86l1.83,1a4.39,4.39,0,0,1-3.83,1.84a4.78,4.78,0,0,1-3.5-1.29,4.35,4.35,0,0,1-1.32-3.25A4.37,4.37,0,0,1,114.76,8a4.48,4.48,0,0,1,3.34-1.31A4.19,4.19,0,0,1,121.29,8a4.45,4.45,0,0,1,1.26,3.22A4.84,4.84,0,0,1,122.46,12.09ZM118.1,8.64a2.18,2.18,0,0,0-2.3,1.74h4.48A2.11,2.11,0,0,0,118.1,8.64Zm-8,1.7c0-1-.54-1.63-1.48-1.63S107,9.4,107,10.65v4.83h-2.27V10.34c0-1-.54-1.63-1.47-1.63s-1.66.69-1.66,1.94v4.83H99.32V6.89h2.27V7.8A2.76,2.76,0,0,1,104,6.65a2.61,2.61,0,0,1,2.39,1.24,3,3,0,0,1,2.62-1.24,3.22,3.22,0,0,1,3.32,3.54v5.29H110.1ZM95.36,15.27a1.44,1.44,0,0,1,0-2.06,1.52,1.52,0,0,1,2.11,0,1.44,1.44,0,0,1,0,2.06A1.52,1.52,0,0,1,95.36,15.27Z"></path> </g> </g> </svg>

                <h1 class="h3 mb-4 fw-normal">Select Companies</h1>

                <!-- Connection Info -->
                <div class="alert alert-success mb-4" role="alert">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-check-circle me-2"></i>
                        <div>
                            <strong>Successfully connected!</strong><br>
                            <small id="connection-info">Cluster: <span id="connected-cluster"></span> | Domain: <span id="connected-domain"></span></small>
                        </div>
                    </div>
                </div>

                <!-- Loading state -->
                <div id="companies-loading" class="text-center py-4">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading companies...</span>
                    </div>
                    <p class="mt-2 text-muted">Loading companies from cluster...</p>
                </div>

                <!-- Companies selection -->
                <div id="companies-container" style="display: none;">
                    <form id="companies-form">
                        <div class="mb-3">
                            <label class="form-label">Select companies for booking report:</label>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="select-all-companies">
                                <label class="form-check-label fw-bold" for="select-all-companies">
                                    Select All
                                </label>
                            </div>
                            <hr class="my-2">
                            <div id="companies-list" class="companies-list">
                                <!-- Companies will be populated here -->
                            </div>
                        </div>

                        <!-- Report Filters -->
                        <div class="report-filters mb-4">
                            <h5 class="mb-3">Report Parameters</h5>
                            <div class="row">
                                <div class="col-md-4">
                                    <div class="form-floating mb-3">
                                        <input type="date" class="form-control" id="date_from" name="date_from">
                                        <label for="date_from">Booking Date From</label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-floating mb-3">
                                        <input type="date" class="form-control" id="date_to" name="date_to">
                                        <label for="date_to">Booking Date To</label>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="form-floating mb-3">
                                        <select class="form-select" id="booking_status" name="booking_status">
                                            <option value="" selected>All Statuses</option>
                                            <option value="confirmed" >Confirmed</option>
                                            <option value="confirmed_pending">Confirmed Pending</option>
                                            <option value="pending">Pending</option>
                                            <option value="canceled">Canceled</option>
                                        </select>
                                        <label for="booking_status">Booking Status</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="form-floating mb-3">
                                        <input type="date" class="form-control" id="created_date_from" name="created_date_from">
                                        <label for="created_date_from">Created Date From</label>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="form-floating mb-3">
                                        <input type="date" class="form-control" id="created_date_to" name="created_date_to">
                                        <label for="created_date_to">Created Date To</label>
                                    </div>
                                </div>
                            </div>
                            <small class="text-muted">
                                <strong>Booking Date</strong> filters apply to booking start time.
                                <strong>Created Date</strong> filters apply to when the booking was created.
                                All filters are optional.
                            </small>
                        </div>

                        <div class="d-flex justify-content-between">
                            <button type="button" class="btn btn-secondary" id="back-to-auth">
                                <i class="fas fa-arrow-left me-2"></i>Back to Authentication
                            </button>
                            <button type="submit" class="btn btn-primary" id="proceed-to-report" disabled>
                                <i class="fas fa-chart-line me-2"></i>Generate Report
                                <span class="badge bg-light text-primary ms-2" id="selected-count">0</span>
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Error state -->
                <div id="companies-error" class="alert alert-danger" style="display: none;">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    <span id="companies-error-message"></span>
                    <div class="mt-2">
                        <button class="btn btn-outline-danger btn-sm" id="retry-companies">
                            <i class="fas fa-redo me-1"></i>Retry
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="step step-3 hidden">
            <!-- Step 3 will be for the actual report -->
        </div>

    </main>
</div>
</body>
</html>
